<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Qu√™te de Kaamelott | Tr√©sor Perdu</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;700&family=IM+Fell+English+SC&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style2.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="maze3d.css">
</head>


<body>
    <!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Qu√™te de Kaamelott | Tr√©sor Perdu</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;700&family=IM+Fell+English+SC&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style2.css">
    <link rel="stylesheet" href="style.css">
</head>


<body>
    <header class="site-header">
        <div class="simple-nav">
            <a class="nav-button nav-about" href="about.html" aria-label="√Ä propos">üë§</a>
        </div>
    </header>
    <div class="background-block">
        <div
            style="display: flex; justify-content: space-between; align-items: center; text-align: center; margin-top: 20px; padding: 50px;">
            <div class="card-body" style="max-width: 600px;">
                <h1>Royaume de Kaamelott</h1>
                <p>Aidez le roi Arthur √† accomplir sa qu√™te et √† d√©couvrir le tr√©sor cach√©.</p>
                <p>Le roi Arthur s'est vu confier une qu√™te par la Dame du Lac. Celle-ci lui a r√©v√©l√©
                    l'existence d'un tr√©sor inestimable cach√© dans un labyrinthe myst√©rieux. Votre mission est de guider
                    Arthur dans cette aventure √©pique.</p>
            </div>
            <div>
                <button class="scroll-btn" onclick="startTutorial()">Commencer le jeu !</button>
            </div>
        </div>

        <!-- Didacticiel overlay -->
        <div id="tutorial-overlay" class="tutorial-overlay" style="display: none;" role="dialog" aria-modal="true"
            aria-labelledby="tutorial-title">
            <div class="tutorial-content">
                <h2 id="tutorial-title" style="margin:0 0 8px 0;">Didacticiel</h2>
                <p id="tutorial-text"></p>
                <div style="margin-top:10px;">
                    <button id="tutorial-next" class="tutorial-btn" aria-label="Suivant">Suivant</button>
                </div>
            </div>
        </div>
    </div>

    <div class="app-container">
        <!-- Panneau lat√©ral -->
        <div class="sidebar">
            <button class="sidebar-btn active" onclick="showPhase('map')">
                <i class="fas fa-map"></i>
            </button>
            <button class="sidebar-btn" onclick="showPhase('maze')">
                <i class="fas fa-dungeon"></i>
            </button>
        </div>

        <!-- Contenu principal -->
        <div class="main-content">
            <!-- Phase Carte -->
            <div id="map-container" class="phase-content active">
                <div id="map"></div>

                <!-- Menu flottant -->
                <div class="floating-menu">
                    <div class="menu-actions">
                        <button class="menu-btn" onclick="findShortestPath()" data-title="Calculer la route">
                            <i class="fas fa-route"></i>
                        </button>
                        <button class="menu-btn" onclick="clearPath()" data-title="Effacer la route">
                            <i class="fas fa-eraser"></i>
                        </button>
                        <button class="menu-btn" onclick="clearWaypoints()" data-title="R√©initialiser">
                            <i class="fas fa-redo"></i>
                        </button>
                        <button class="menu-btn" onclick="centerPau()" data-title="Centrer sur Pau">
                            <i class="fas fa-globe"></i>
                        </button>
                    </div>
                    <div class="menu-legend">
                        <h4>L√©gende (cliquez pour localiser)</h4>
                        <div class="legend-grid">
                            <!-- B -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('bank')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/bank.png' width='35' height='35' /></span>
                                <p>Banque</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('bar')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/bar.png' width='35' height='35' /></span>
                                <p>Bar</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('beauty')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/beauty.png' width='35' height='35' /></span>
                                <p>Beaut√©</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('jewelry')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/jewelry.png' width='35' height='35' /></span>
                                <p>Bijouterie</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('bakery')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/bakery.png' width='35' height='35' /></span>
                                <p>Boulangerie</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('butcher')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/butcher.png' width='35' height='35' /></span>
                                <p>Boucherie</p>
                            </div>
                            <!-- C -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('cafe')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/cafe.png' width='35' height='35' /></span>
                                <p>Caf√©</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('car')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/car.png' width='35' height='35' /></span>
                                <p>Concessionnaire</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('car_repair')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/car_repair.png' width='35' height='35' /></span>
                                <p>Garage auto</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('car_wash')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/car_wash.png' width='35' height='35' /></span>
                                <p>Lavage auto</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('cinema')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/cinema.png' width='35' height='35' /></span>
                                <p>Cin√©ma</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('clothes')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/clothes.png' width='35' height='35' /></span>
                                <p>V√™tements</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('shoes')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/shoes.png' width='35' height='35' /></span>
                                <p>Chaussures</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('hairdresser')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/hairdresser.png' width='35' height='35' /></span>
                                <p>Coiffeur</p>
                            </div>
                            <!-- E -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('educational_institution')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/educational_institution.png' width='35' height='35' /></span>
                                <p>√âcole</p>
                            </div>
                            <!-- F -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('fast_food')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/fast_food.png' width='35' height='35' /></span>
                                <p>Fast-food</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('florist')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/florist.png' width='35' height='35' /></span>
                                <p>Fleuriste</p>
                            </div>
                            <!-- L -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('books')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/books.png' width='35' height='35' /></span>
                                <p>Librairie</p>
                            </div>
                            <!-- M -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('toys')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/toys.png' width='35' height='35' /></span>
                                <p>Magasin de jouets</p>
                            </div>
                            <!-- N -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('nightclub')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/nightclub.png' width='35' height='35' /></span>
                                <p>Boite de nuit</p>
                            </div>
                            <!-- O -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('optician')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/optician.png' width='35' height='35' /></span>
                                <p>Opticien</p>
                            </div>
                            <!-- P -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('pharmacy')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/pharmacy.png' width='35' height='35' /></span>
                                <p>Pharmacie</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('pub')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/pub.png' width='35' height='35' /></span>
                                <p>Pub</p>
                            </div>
                            <!-- R -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('restaurant')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/restaurant.png' width='35' height='35' /></span>
                                <p>Restaurant</p>
                            </div>
                            <!-- S -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('sports')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/sports.png' width='35' height='35' /></span>
                                <p>Sport</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('convenience')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/convenience.png' width='35' height='35' /></span>
                                <p>Sup√©rette</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('supermarket')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/supermarket.png' width='35' height='35' /></span>
                                <p>Supermarch√©</p>
                            </div>
                            <!-- T -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('tobacco')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/tobacco.png' width='35' height='35' /></span>
                                <p>Tabac</p>
                            </div>
                            <div class="legend-item clickable" onclick="centerOnCommerceType('tattoo')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/tattoo.png' width='35' height='35' /></span>
                                <p>Tatouage</p>
                            </div>
                            <!-- V -->
                            <div class="legend-item clickable" onclick="centerOnCommerceType('e-cigarette')"
                                data-title="Cliquez pour localiser le plus proche">
                                <span><img src='/icons/e-cigarette.png' width='35' height='35' /></span>
                                <p>Vape Shop</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Infos et l√©gende -->
                <div class="info-overlay">
                    <div id="map-status" class="status">Clic droit pour ajouter un waypoint</div>
                    <div class="legend">
                        <div class="legend-item" onclick="centerKaamelott()" data-title="Centrer sur ma position">
                            <div class="legend-color" style="background: var(--emerald);"></div>
                            <span>Kaamelott</span>
                        </div>
                        <div class="legend-item" onclick="centerLabyrinthe()" data-title="Centrer sur le labyrinthe">
                            <div class="legend-color" style="background: var(--ruby);"></div>
                            <span>Ch√¢teau</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Phase Labyrinthe -->
            <div id="maze-container" class="phase-content">
                <!-- Labyrinthe 2D original (cach√© par d√©faut) -->
                <div id="maze" style="display: none;"></div>

                <!-- Nouveau conteneur 3D -->
                <div id="maze3d-container">
                    <canvas id="maze3d-canvas"></canvas>
                </div>

                <!-- Menu flottant avec ajout des contr√¥les 3D -->
                <div class="floating-menu">
                    <div class="menu-actions">
                        <button class="menu-btn" onclick="generateMaze3D()" data-title="Nouveau labyrinthe">
                            <i class="fas fa-random"></i>
                        </button>
                        <button class="menu-btn" onclick="solveMaze3D()" data-title="R√©soudre">
                            <i class="fas fa-puzzle-piece"></i>
                        </button>
                        <button class="menu-btn" onclick="startArthurJourney3D()" data-title="Animation Arthur">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="menu-btn" onclick="resetMaze3D()" data-title="Reset">
                            <i class="fas fa-undo"></i>
                        </button>
                    </div>

                    <!-- Nouveau panneau de contr√¥les de vue -->
                    <div class="menu-legend">
                        <h4>Mode de vue</h4>
                        <div class="view-controls-grid">
                            <div class="legend-item view-btn active" onclick="setViewMode('topdown')"
                                data-title="Vue d'au-dessus">
                                <span><i class="fas fa-eye"></i></span>
                                <p>Vue du dessus</p>
                            </div>
                            <div class="legend-item view-btn" onclick="setViewMode('thirdperson')"
                                data-title="Troisi√®me personne">
                                <span><i class="fas fa-user"></i></span>
                                <p>3√®me personne</p>
                            </div>
                            <div class="legend-item view-btn" onclick="setViewMode('firstperson')"
                                data-title="Premi√®re personne">
                                <span><i class="fas fa-video"></i></span>
                                <p>POV</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contr√¥les de mouvement pour la premi√®re personne -->
                <div id="movement-controls" class="movement-controls" style="display: none;">
                    <div class="controls-layout">
                        <button class="move-btn" onclick="moveArthur('forward')" data-title="Avancer">
                            <i class="fas fa-arrow-up"></i>
                        </button>
                        <div class="side-controls">
                            <button class="move-btn" onclick="moveArthur('left')" data-title="Gauche">
                                <i class="fas fa-arrow-left"></i>
                            </button>
                            <button class="move-btn" onclick="moveArthur('backward')" data-title="Reculer">
                                <i class="fas fa-arrow-down"></i>
                            </button>
                            <button class="move-btn" onclick="moveArthur('right')" data-title="Droite">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="info-overlay">
                    <div id="maze-status" class="status">G√©n√©rez un labyrinthe 3D !</div>
                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--emerald);"></div>
                            <span>Entr√©e</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--gold);"></div>
                            <span>Tr√©sor</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #4169e1;"></div>
                            <span>Arthur</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--ruby);"></div>
                            <span>Solution</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="script.js"></script>
    <script src="maze3d.js"></script>

</body>

</html>